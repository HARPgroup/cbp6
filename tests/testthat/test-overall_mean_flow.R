context("overall_mean_flow")
library(cbp6)
first_date <- as.Date("2013-10-01")
date <- first_date+c(0:729)
data <- data.frame(date,flow = c(73.7, 75.3, 75.3, 75.3, 288, 275, 57.3, 57, 58.6, 58.7, 58.7, 272, 
                                 264, 57, 57, 57, 57.2, 57, 294, 329, 42.9, 51.9, 57.9, 58.7, 58.7,
                                 442, 422, 62.8, 62.3, 63.7, 64.1, 64.2, 64.1, 64.1, 226, 636, 879,
                                 509, 411, 285, 285, 285, 168, 107, 233, 160, 67.7, 67.8, 149, 256,
                                 283, 282, 282, 281, 281, 280, 430, 937, 618, 431, 159, 159, 386,
                                 390, 141, 112, 661, 1270, 1520, 1880, 2140, 2190, 1030, 280, 136,
                                 136, 439, 578, 413, 117, 138, 200, 202, 842, 1180, 1170, 682, 246,
                                 264, 267, 1180, 1440, 867, 1060, 957, 555, 260, 50.4, 204, 294,
                                 295, 452, 331, 333, 1270, 1600, 737, 491, 375, 237, 237, 238, 321,
                                 365, 274, 111, 39.6, 40.3, 183, 272, 272, 189, 119, 119, 119, 840,
                                 1960, 1170, 714, 1300, 713, 713, 340, 114, 270, 358, 359, 359, 360,
                                 361, 707, 1010, 1190, 1130, 1000, 1010, 776, 531, 468, 358, 297, 
                                 185, 185, 566, 787, 785, 861, 740, 740, 740, 628, 412, 562, 560,
                                 387, 308, 310, 363, 627, 709, 526, 404, 340, 340, 340, 195, 156,
                                 224, 222, 223, 224, 224, 79, 12.3, 14.8, 15.1, 15.1, 15.1, 13.5,
                                 12.5, 12.4, 12.4, 12.4, 12.5, 12.5, 12.7, 31.6, 43, 53, 56, 55.9,
                                 55.8, 55.8, 56.1, 56.2, 56.1, 56.1, 56.1, 56.3, 56.6, 56.8, 56.9,
                                 57, 57, 57.1, 57.1, 212, 289, 245, 189, 121, 73.4, 73.3, 73.3,
                                 73.6, 86.8, 277, 273, 235, 232, 143, 121, 121, 121, 122, 123, 123,
                                 91.8, 77.8, 78.3, 78.6, 326, 301, 120, 61.1, 61.5, 61.9, 154, 197,
                                 110, 73.2, 73.3, 73.4, 127, 151, 420, 218, 77.2, 77.2, 77.3, 76.1,
                                 75.7, 198, 799, 280, 52.8, 52.6, 60.8, 71.4, 71.4, 71.4, 71.6, 154,
                                 152, 87.6, 78.8, 79, 65.5, 57, 57, 57.1, 55.4, 54.2, 54.4, 54.4, 54.5,
                                 54.7, 430, 412, 200, 82.7, 61, 349, 256, 135, 121, 148, 149, 149, 149,
                                 149, 149, 112, 83.6, 55.3, 55.4, 55.6, 55.7, 55.7, 225, 111, 53.6, 201,
                                 402, 408, 180, 75.8, 153, 190, 190, 191, 191, 191, 191, 210, 705, 1510,
                                 1150, 154, 133, 141, 115, 115, 116, 116, 117, 103, 109, 182, 182, 182,
                                 281, 353, 107, 107, 107, 229, 224, 137, 73.2, 73.3, 73.3, 72.2, 72.7,
                                 72.3, 72.1, 72.8, 72.6, 73.1, 73.3, 73.3, 73.3, 73.3, 75.1, 75.5, 75.5,
                                 75.6, 75.3, 307, 307, 62.6, 153, 300, 305, 237, 109, 203, 467, 996, 1140,
                                 886, 465, 463, 517, 331, 268, 186, 138, 138, 439, 458, 132, 107, 107,
                                 136, 186, 251, 250, 744, 1100, 798, 649, 649, 650, 649, 647, 646, 646, 
                                 570, 449, 448, 447, 447, 447, 446, 446, 446, 445, 444, 445, 357, 303,
                                 302, 302, 301, 298, 267, 178, 185, 335, 457, 384, 385, 731, 733, 456,
                                 400, 290, 182, 182, 182, 175, 210, 258, 166, 107, 107, 108, 107, 243,
                                 183, 184, 184, 184, 850, 922, 615, 495, 378, 270, 269, 349, 402, 404,
                                 373, 246, 185, 185, 185, 205, 263, 230, 198, 167, 168, 168, 211, 235,
                                 225, 173, 151, 152, 432, 705, 630, 234, 231, 280, 280, 294, 712, 728,
                                 464, 321, 244, 244, 244, 244, 244, 244, 146, 67.7, 67.9, 68, 67.7,
                                 252, 349, 301, 185, 185, 1150, 1750, 1530, 598, 352, 352, 352, 727,
                                 1600, 457, 24.2, 23.2, 1860, 3950, 3920, 2670, 766, 3300, 3890, 3840,
                                 3790, 2780, 1290, 606, 542, 606, 544, 543, 461, 364, 381, 388, 760, 991,
                                 991, 592, 454, 148, 14.2, 12.4, 11.9, 11.8, 11.8, 12.1, 12.1, 12.1, 13.1,
                                 12.9, 12.9, 12.9, 409, 1320, 1400, 809, 482, 591, 748, 748, 683, 445, 387,
                                 387, 663, 1080, 643, 491, 505, 436, 437, 437, 385, 299, 231, 232, 232, 188,
                                 191, 221, 198, 113, 114, 114, 213, 245, 165, 165, 165, 165, 165, 165, 165,
                                 165, 87.1, 55.3, 55.4, 55.3, 55.3, 55.3, 55.7, 56.5, 81, 315, 285, 170, 170,
                                 93.7, 62.3, 62.3, 62.3, 62.3, 62.3, 62.3, 62.3, 62.4, 62.1, 60.5, 66.2, 279,
                                 164, 101, 71.6, 71.4, 71.5, 71.7, 130, 254, 189, 71.4, 70.6, 69.6, 84.7, 278,
                                 277, 638, 419, 182, 121, 121, 121, 121, 119, 865, 1920, 1580, 590, 262, 196,
                                 169, 111, 146, 159, 160, 160, 160, 126, 65.4, 84.6, 99, 86.1, 67.7, 67.7,
                                 67.7, 59.9, 47, 47.1, 47, 47, 47, 47.2, 47.5, 54.1, 57, 57, 57, 57, 57.1,
                                 151, 209, 131, 87.3, 87.5, 88.1, 89.3, 89.4, 64.5, 50.6, 50.6, 48.6, 48.6,
                                 48.6, 48.6, 48.6, 48.1, 47.3, 47, 47, 47, 46.9, 47, 47, 47, 47, 47, 47, 47,
                                 47, 47, 47, 47, 47, 47, 72.3, 49.1, 47, 47, 47, 47, 47, 47.4, 47.9))

test_that(
  "a description of my test",
  {
    expect_equal(overall_mean_flow(data), 327)
  }
)